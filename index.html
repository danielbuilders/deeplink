<!DOCTYPE html>
<html>
<head>
    <title>Redirecionamento de Aplicativo</title>
</head>
<body>
    <script>
        function verifyAndRedirectApp() {
            const urlParams = window.location.search;
            const appScheme = `assaipj://app/${urlParams}`;

            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            const isIOS = /iPad|iPhone/.test(userAgent) && !window.MSStream;
            const isAndroid = /android/i.test(userAgent);

            const fallbackURL = isIOS
                ? "https://apps.apple.com/br/app/meu-assa%C3%AD/id979078703"
                : "https://play.google.com/store/apps/details?id=br.com.assai.tokenpj";

            const fallbackWebsite = "https://www.assai.com.br";

            setTimeout(function () {
                window.location.href = fallbackURL;

                // Segunda tentativa de fallback para o site, caso loja tambÃ©m falhe
                setTimeout(() => {
                    window.location.href = fallbackWebsite;
                }, 1500);
            }, 1500);

            // Disparo do deeplink
            if (isAndroid) {
                const iframe = document.createElement("iframe");
                iframe.style.display = "none";
                iframe.src = appScheme;
                document.body.appendChild(iframe);
            } else {
                window.location.href = appScheme;
            }
        }

        window.onload = verifyAndRedirectApp;
    </script>
</body>
</html>
